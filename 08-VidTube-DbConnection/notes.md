# Database Connection

1. MongoDb Atlas - Cloud Database service from MongoDb
   1. Correct IP address
   2. username & password
   3. connection string
2. Configure environment variables
   1. PORT
      - Choose any available port from your local system
   2. MONGODB_URI
      - Prefer to avoid special characters in the password
      - Make sure to remove the last backslash from the connection string

# Things to keep in mind while interacting with Database

- When you try to interact with Database,
  1. there is high chance that you will get into problems.Therefore always wrap the code in try-catch block or use promises to resolve the errors.
  2. there is high chance that Database takes ample amount of time to respond to your queries due to the reason that Databases are hosted in some random place that might be far from you (Another Continent). Hence always use Async await while connecting with Database.

```javascript
require("dotenv").config({ path: "./env" });

import mongoose from "mongoose";
import { DB_NAME } from "../constants";

import express from "express";

const app = express();

// IIFE
(async () => {
  try {
    await mongoose.connect(`${process.env.MONGODB_URI}/${DB_NAME}`);

    // events generated by express
    app.on("error", (err) => {
      console.log("ERRR : ", err);
      throw err;
    });

    // starting the express server
    app.listen(process.env.PORT, () => {
      console.log("APP is listening on port : ${process.env.PORT}");
    });
  } catch (error) {
    console.error("ERR :", error);
    throw error;
  }
})();
```

# NOTE

- If you made any changes to .env files while the server is running, then nodemon will not restart the system automatically, you should restart it manually.

# Middlewares

- Simply put, middlewares are used to validate wheather you are authorized to perform the task that you intended to do.
- In most of the case we use app.use() to handle the middlewares.

1. CORS - Cross Origin Resource Sharing
   - app.use()
2. cookie-parser - to access the cookees in the client browser

```
res.send(err, res, res, next)
-> next refers to middleware
```

# AsyncHandler

- We can use either try-catch syntax or promises to create this service
- AsyncHandler is a HigherOrder fucntion.
- A function that either accepts other function as a parameter or return a function as a result is called Higher Order Function.

```javascript
// Using try-catch block
const asyncHandler = (fn) => async (req, res, next) => {
  try {
    await fn(req, res, next);
  } catch (error) {
    res.status(error.code || 500);
    res.json({
      success: true,
      message: error.message,
    });
  }
};
```

# Standarising API Error

- NodeJs provies a Error class to handle the error responses from the server.
- We are overwriting the predefined error responses to match our requirements.

# Standarisng API Responses

- We are defining standard API responses to match our requirements.
